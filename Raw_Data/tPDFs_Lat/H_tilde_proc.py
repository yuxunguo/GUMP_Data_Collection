import numpy as np
import pandas as pd

x_vals = [0.195, 0.205, 0.215, 0.225, 0.235, 0.245, 0.255, 0.265, 0.275, 0.285, 0.295, 0.305,
            0.315, 0.325, 0.335, 0.345, 0.355, 0.365, 0.375, 0.385, 0.395, 0.405, 0.415, 0.425,
            0.435, 0.445, 0.455, 0.465, 0.475, 0.485, 0.495, 0.505, 0.515, 0.525, 0.535, 0.545,
            0.555, 0.565, 0.575, 0.585, 0.595, 0.605, 0.615, 0.625, 0.635, 0.645, 0.655, 0.665,
            0.675, 0.685, 0.695, 0.705]
# 100 -> 0.17, 200->0.65, 300->1.38, 110->0.34, 220->1.24, 120->0.81
t_vals = -1*np.array([0.17,0.65,1.38,0.34,1.24,0.81])

#H-tilde (LI definition)
Q = 100
dat1 = [1.487109, 1.462978, 1.439667, 1.417105, 1.395235, 1.374, 1.353349, 1.333227, 1.313577, 1.294341, 1.275457, 1.256866, 1.23851, 1.220336, 1.202295, 1.184349, 1.166464, 1.148618, 1.130798, 1.112996, 1.095213, 1.077455, 1.059733, 1.042058, 1.024442, 1.006897, 0.989433, 0.972057, 0.954772, 0.93758, 0.92048, 0.903468, 0.886541, 0.869694, 0.852924, 0.83623, 0.819612, 0.803075, 0.786623, 0.770267, 0.754014, 0.737877, 0.721867, 0.705995, 0.690269, 0.674698, 0.659285, 0.644034, 0.628942, 0.614007, 0.599223, 0.584585]

err1 = [0.056932, 0.055113, 0.053366, 0.051694, 0.050096, 0.048572, 0.04712, 0.045736, 0.044417, 0.043157, 0.041952, 0.040796, 0.039684, 0.038612, 0.037576, 0.036573, 0.035599, 0.034655, 0.033737, 0.032846, 0.031981, 0.031142, 0.03033, 0.029545, 0.028786, 0.028053, 0.027345, 0.026663, 0.026004, 0.025367, 0.024751, 0.024155, 0.023575, 0.023012, 0.022464, 0.021928, 0.021405, 0.020893, 0.020392, 0.019901, 0.01942, 0.018948, 0.018487, 0.018035, 0.017593, 0.017161, 0.016738, 0.016324, 0.015918, 0.015521, 0.015131, 0.014749]


Q = 200
dat2 = [1.109487, 1.093661, 1.078424, 1.06371, 1.049463, 1.035632, 1.02217, 1.009032, 0.996171, 0.983543, 0.971104, 0.95881, 0.946621, 0.934502, 0.922421, 0.910351, 0.898272, 0.886171, 0.874038, 0.861871, 0.849669, 0.837439, 0.825186, 0.812919, 0.800646, 0.788374, 0.776109, 0.763856, 0.751617, 0.739392, 0.72718, 0.71498, 0.702789, 0.690605, 0.678426, 0.666254, 0.654089, 0.641936, 0.629801, 0.617693, 0.605618, 0.593588, 0.581612, 0.569698, 0.557855, 0.546089, 0.534403, 0.522801, 0.511282, 0.499843, 0.488483, 0.477196]

err2 = [0.047936, 0.046752, 0.04561, 0.044509, 0.043446, 0.042419, 0.041425, 0.040462, 0.039527, 0.038616, 0.037727, 0.036857, 0.036004, 0.035166, 0.034344, 0.033535, 0.03274, 0.031958, 0.031192, 0.030441, 0.029706, 0.028988, 0.028288, 0.027606, 0.026942, 0.026297, 0.025669, 0.02506, 0.024467, 0.02389, 0.023328, 0.02278, 0.022245, 0.021722, 0.021211, 0.020711, 0.020222, 0.019743, 0.019276, 0.01882, 0.018375, 0.017943, 0.017522, 0.017115, 0.01672, 0.016338, 0.015968, 0.015611, 0.015266, 0.014933, 0.01461, 0.014297]


Q = 300
dat3 = [0.763812, 0.752926, 0.742495, 0.732476, 0.722834, 0.713533, 0.704542, 0.695827, 0.687355, 0.679093, 0.671006, 0.663062, 0.655229, 0.647476, 0.639776, 0.632106, 0.624448, 0.616786, 0.609109, 0.60141, 0.593687, 0.585937, 0.578162, 0.570366, 0.56255, 0.554719, 0.546875, 0.539019, 0.531154, 0.52328, 0.515394, 0.507497, 0.499587, 0.491663, 0.483724, 0.475769, 0.467801, 0.459822, 0.451834, 0.443843, 0.435853, 0.427871, 0.419901, 0.411949, 0.404021, 0.396119, 0.388247, 0.380404, 0.372593, 0.364811, 0.357056, 0.349327]

err3 = [0.05198, 0.051073, 0.050218, 0.049407, 0.048636, 0.047899, 0.047191, 0.046505, 0.045838, 0.045184, 0.044541, 0.043905, 0.043275, 0.042648, 0.042026, 0.041407, 0.040792, 0.040182, 0.039578, 0.03898, 0.03839, 0.037807, 0.037233, 0.036668, 0.036111, 0.035562, 0.035021, 0.034486, 0.033957, 0.033432, 0.032911, 0.032394, 0.031878, 0.031364, 0.030851, 0.030339, 0.029829, 0.029321, 0.028814, 0.028311, 0.027812, 0.027317, 0.026828, 0.026344, 0.025867, 0.025396, 0.024933, 0.024476, 0.024025, 0.023581, 0.023142, 0.022708]


Q = 110
dat4 = [1.191101, 1.174071, 1.157637, 1.141731, 1.126292, 1.111268, 1.096609, 1.082267, 1.068196, 1.054348, 1.04068, 1.027147, 1.013709, 1.00033, 0.986979, 0.973629, 0.960261, 0.946863, 0.933426, 0.919951, 0.906439, 0.892898, 0.879336, 0.865763, 0.852189, 0.838624, 0.825074, 0.811545, 0.79804, 0.784559, 0.771101, 0.757665, 0.744248, 0.730847, 0.717462, 0.704091, 0.690737, 0.677405, 0.6641, 0.650832, 0.637609, 0.624443, 0.611343, 0.59832, 0.585383, 0.572538, 0.55979, 0.547142, 0.534593, 0.522144, 0.50979, 0.497527]

err4 = [0.05872, 0.057049, 0.05547, 0.05398, 0.052578, 0.051259, 0.050015, 0.048842, 0.04773, 0.046672, 0.04566, 0.044688, 0.04375, 0.04284, 0.041954, 0.04109, 0.040245, 0.039419, 0.038611, 0.037821, 0.037049, 0.036295, 0.035561, 0.034846, 0.03415, 0.033472, 0.032811, 0.032167, 0.031537, 0.030921, 0.030315, 0.029718, 0.029129, 0.028545, 0.027966, 0.027389, 0.026815, 0.026242, 0.025671, 0.025102, 0.024534, 0.023969, 0.023407, 0.022848, 0.022294, 0.021743, 0.021198, 0.020657, 0.02012, 0.019589, 0.019062, 0.01854]


Q = 220
dat5 = [0.651558, 0.643466, 0.63572, 0.628275, 0.62109, 0.614132, 0.607367, 0.600766, 0.594301, 0.587946, 0.581675, 0.575465, 0.569295, 0.563146, 0.557002, 0.550852, 0.544685, 0.538494, 0.532278, 0.526034, 0.519764, 0.51347, 0.507156, 0.500826, 0.494483, 0.488131, 0.481772, 0.475407, 0.469035, 0.462656, 0.456266, 0.449863, 0.443444, 0.437006, 0.430546, 0.424063, 0.417557, 0.411027, 0.404477, 0.397908, 0.391325, 0.384732, 0.378134, 0.371536, 0.364942, 0.358356, 0.35178, 0.345217, 0.338667, 0.33213, 0.325607, 0.319096]

err5 = [0.061697, 0.060239, 0.058864, 0.057569, 0.056345, 0.055185, 0.054079, 0.05302, 0.051998, 0.051007, 0.050038, 0.049086, 0.048148, 0.04722, 0.046302, 0.045391, 0.04449, 0.043598, 0.042718, 0.041851, 0.040998, 0.040161, 0.039342, 0.03854, 0.037756, 0.03699, 0.036241, 0.035508, 0.034789, 0.034083, 0.033388, 0.032703, 0.032026, 0.031356, 0.030693, 0.030036, 0.029384, 0.028739, 0.028101, 0.02747, 0.026848, 0.026237, 0.025636, 0.025047, 0.024471, 0.023908, 0.023359, 0.022824, 0.022302, 0.021793, 0.021297, 0.020813]


Q = 120 
dat6 = [0.909481, 0.896818, 0.884609, 0.872797, 0.861331, 0.850168, 0.839269, 0.828595, 0.818111, 0.807781, 0.797573, 0.787455, 0.777399, 0.767381, 0.757379, 0.747377, 0.737363, 0.727331, 0.717278, 0.707206, 0.697118, 0.687023, 0.676927, 0.666839, 0.656768, 0.646719, 0.636698, 0.626708, 0.616749, 0.606821, 0.596921, 0.587045, 0.577188, 0.567347, 0.557517, 0.547697, 0.537886, 0.528085, 0.518297, 0.508527, 0.498781, 0.489065, 0.479388, 0.469756, 0.460176, 0.450654, 0.441193, 0.431797, 0.422467, 0.413201, 0.404, 0.394861]

err6 = [0.050676, 0.049518, 0.048418, 0.047371, 0.046372, 0.045417, 0.0445, 0.043615, 0.042758, 0.041922, 0.041104, 0.0403, 0.039507, 0.038724, 0.037949, 0.037182, 0.036423, 0.035674, 0.034936, 0.03421, 0.033497, 0.0328, 0.032119, 0.031455, 0.030809, 0.03018, 0.029568, 0.028971, 0.02839, 0.027822, 0.027265, 0.026719, 0.026181, 0.02565, 0.025124, 0.024603, 0.024086, 0.023572, 0.023062, 0.022555, 0.022052, 0.021553, 0.021059, 0.02057, 0.020087, 0.019611, 0.019142, 0.01868, 0.018226, 0.017779, 0.017339, 0.016907]


def select_rows(arr):
    return arr[(arr[:, 0] >= 0.3) & (arr[:, 0] <= 0.7)]

mu0 = 2
# Sample only 10 different x to avoid the strong correlations.
x_select = 4*np.array(range(10))

output_data1 = select_rows(np.transpose([x_vals, t_vals[0]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat1, err1]))[x_select]
output_data2 = select_rows(np.transpose([x_vals, t_vals[1]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat2, err2]))[x_select]
output_data3 = select_rows(np.transpose([x_vals, t_vals[2]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat3, err3]))[x_select]
output_data4 = select_rows(np.transpose([x_vals, t_vals[3]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat4, err4]))[x_select]
output_data5 = select_rows(np.transpose([x_vals, t_vals[4]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat5, err5]))[x_select]
output_data6 = select_rows(np.transpose([x_vals, t_vals[5]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat6, err6]))[x_select]

output_data = np.vstack([output_data1, output_data2, output_data3, output_data4, output_data5, output_data6])

df = pd.DataFrame(output_data, columns = ["x", "t", "mu", "f", "delta f"])
df["GPD type"] = 2
df["flavor"] = "NS"

print(df)

df.to_csv("Ht_LI.csv", index=False)
