import numpy as np
import pandas as pd

x_vals = [0.39698492, 0.40703518, 0.41708543, 0.42713568, 0.43718593, 0.44723618,
            0.45728643, 0.46733668, 0.47738693, 0.48743719, 0.49748744, 0.50753769,
            0.51758794, 0.52763819, 0.53768844, 0.54773869, 0.55778894, 0.5678392,
            0.57788945, 0.5879397,  0.59798995, 0.6080402,  0.61809045, 0.6281407,
            0.63819095, 0.64824121, 0.65829146, 0.66834171, 0.67839196, 0.68844221,
            0.69849246, 0.70854271]
# 100 -> 0.17, 200->0.65, 300->1.38, 110->0.34, 220->1.24, 120->0.81
t_vals = -1*np.array([0.17,0.65,1.38,0.34,1.24,0.81])

Q = 100
dat1 = [0.6421288786104973, 0.5915802370526668, 0.543883357991557, 0.49887444942348713, 0.45642282149269087, 0.41641646819163375, 0.3787610528526806, 0.34337153731852604, 0.31016652431812636, 0.27906623117541596, 0.24998883696725727, 0.22284697888998595, 0.19755373140471846, 0.17401379999004868, 0.15213658559493232, 0.13182782570109017, 0.11300123034000406, 0.09557043461148908, 0.07945875126946543, 0.06459806100963197, 0.05092554083753636, 0.0383897982139742, 0.02694208979600193, 0.01654171032524622, 0.00715042310945909, -0.0012710389001192686, -0.008758478160440798, -0.015359761944791751, -0.021116702979004996, -0.02608606210196778, -0.03032519827753144, -0.03390133848130159]

err1 = [0.13828999143380594, 0.13417350122225025, 0.13012591280762045, 0.126161902756374, 0.12227685275491773, 0.1184632472099641, 0.11470799457812893, 0.11099742463729538, 0.10731367010161855, 0.10364614121210448, 0.09997719052914925, 0.0963104342217453, 0.09264342575252703, 0.08898966763820133, 0.08535976662968744, 0.08177849065800154, 0.07826675406983799, 0.07485718321141081, 0.07157580922364933, 0.06845107231934724, 0.06550627266199908, 0.06276057397320306, 0.06022527396456013, 0.057905112467589344, 0.05579735010107848, 0.05389162010155319, 0.052171155801135426, 0.05061927308659404, 0.04921176994293499, 0.04792558073272719, 0.04674003924810724, 0.04563688162530719]

Q = 200
dat2 = [0.5599917640516073, 0.5294511641038383, 0.5002136931676918, 0.47220926571810123, 0.44538451233322157, 0.4196921133901743, 0.39509454863281335, 0.3715561641244724, 0.34904464185341444, 0.32752643804589887, 0.3069668225458934, 0.28732907503405464, 0.26857610183915986, 0.25066800709978965, 0.23356569835802704, 0.21723216138618714, 0.2016313342883109, 0.18672985312156862, 0.17250090167154059, 0.1589193855234671, 0.14596506878548351, 0.13362363336399868, 0.12188093929633922, 0.11072771391666057, 0.1001538721500772, 0.09014989669100755, 0.0807041547762105, 0.07180204927837353, 0.06342632973864935, 0.05555467846997382, 0.04816212121324381, 0.04121813040484929]

err2 = [0.08338840369816966, 0.08038007883294862, 0.07741153131639207, 0.07449433109953643, 0.0716343469219322, 0.0688375900489431, 0.0661038680870383, 0.0634320205627693, 0.0608216298345861, 0.0582710901250283, 0.05578132254171952, 0.05335648650480215, 0.051004185061293034, 0.048735079950078426, 0.04655940740385578, 0.044495568735043164, 0.04255982149081918, 0.040767994139839364, 0.03913469044574061, 0.03766940077958448, 0.036377450599958124, 0.03525590305393046, 0.0342964831037412, 0.033482193856728126, 0.03279274835270939, 0.03220310934841762, 0.03168784820904249, 0.03121966038166145, 0.03077633240132879, 0.030337077054031422, 0.029886278967360697, 0.02941133127115028]

Q = 300
dat3 = [0.38249939212622064, 0.3685204222498447, 0.35484325252074644, 0.3414339185146321, 0.32826583757071054, 0.3153173802198015, 0.30257217389852575, 0.29001732433395133, 0.27764274397401584, 0.26544106648734733, 0.2534066350647912, 0.2415359950249969, 0.22982656538526333, 0.2182787155677999, 0.2068933531466245, 0.19567526512185973, 0.1846303898323665, 0.17376657471540688, 0.16309599615405057, 0.15263079633669627, 0.14238618838847023, 0.13237817657734505, 0.12262362036193672, 0.11313952829717987, 0.10394182155522891, 0.09504518256271609, 0.08646218379791443, 0.0782028724972278, 0.07027444430670807, 0.06268049986351737, 0.05542222542156948, 0.0484967564363137]

err3 = [0.07836693243317412, 0.07583587753185521, 0.07336473998419347, 0.07096343478881893, 0.06863506726335927, 0.06637946396341797, 0.06419286326725884, 0.06206947965973738, 0.06000345498929842, 0.05798736181984108, 0.0560176649566383, 0.05409217595402271, 0.05221139376943194, 0.05038009369087877, 0.04860464096164109, 0.04689315706045364, 0.045256681758008226, 0.043704212094749, 0.042244830954303425, 0.04088478453917254, 0.039627678552394525, 0.03847312816996386, 0.03741531878917189, 0.03644707388116565, 0.035555852736510046, 0.034727926273553034, 0.03394843653282088, 0.03320208626420612, 0.0324752263396389, 0.03175556365370114, 0.031034586797589154, 0.030302958416160732]

Q = 110
dat4 = [0.5480755284391683, 0.5094241236594655, 0.47308010161684927, 0.438870701462853, 0.40665834220348923, 0.3763233063206323, 0.34776322766912826, 0.320886664819043, 0.29560943749987717, 0.2718513361820905, 0.2495336193257967, 0.22857755465014903, 0.2089058109125555, 0.19043666867019973, 0.1730932146717827, 0.15679800113691988, 0.14147970042778735, 0.12706928278315807, 0.1135048743119712, 0.10073195032276416, 0.08870108171857269, 0.07737420952318069, 0.06671397901568447, 0.05669194790959935, 0.04728331194419868, 0.03846497252388103, 0.030216372873748953, 0.02251357035510833, 0.015336024527398698, 0.008656717120118706, 0.0024484536210910486, -0.003319787592367562]

err4 = [0.11234996155260013, 0.10890790701949629, 0.10566242433689932, 0.10264718179863183, 0.09982754950578052, 0.09717872551493423, 0.09466496685665476, 0.09225255906890108, 0.08990578777528248, 0.08759166744016894, 0.08528525410907827, 0.08296977944833732, 0.08063151236708833, 0.07827271062051269, 0.07589886521482316, 0.07352256394778105, 0.0711602342304397, 0.06883248643156167, 0.06656174831479689, 0.06436539560598731, 0.06225947790614603, 0.06026047973068643, 0.05837069087593035, 0.05659452475227816, 0.05492495481405321, 0.053356035729086176, 0.05187603798646635, 0.05047085333801054, 0.04912669666544582, 0.047831824357120405, 0.04657418769280866, 0.04534403066748185]

Q = 220
dat5 = [0.30915863758516005, 0.28561361372239996, 0.263214129692334, 0.24195526886690907, 0.22183428409964026, 0.2028506807880204, 0.185001757425269, 0.16828070005182333, 0.15267393984902614, 0.13816287023526935, 0.12471884084104101, 0.11230556173249423, 0.10088361117844341, 0.09040222869169456, 0.08080997319142934, 0.07205134374434542, 0.06407066446077365, 0.05681198736328536, 0.050222062946766316, 0.04425031621329572, 0.03884980581134404, 0.03397834061218657, 0.02959545247060969, 0.025667512483498325, 0.02216117890011933, 0.019046942428488096, 0.0162955493308809, 0.01387831971665448, 0.011768340317612418, 0.009934606055010039, 0.008348350480893432, 0.006977781645820171]

err5 = [0.08470399554303999, 0.0822567754413399, 0.07995064820731945, 0.07778192650316536, 0.07573867948637551, 0.07380352762011201, 0.0719543645836997, 0.07016882402570465, 0.0684252208828134, 0.06670322912273571, 0.06498538570824947, 0.06326703415825068, 0.06153730566959752, 0.05980121260290418, 0.058064202627873755, 0.05633755454854696, 0.05463428460235399, 0.05296986627449114, 0.05135942743268194, 0.04981585295723512, 0.04834974241692358, 0.04696749489114797, 0.04567278564033518, 0.04446238822500462, 0.04333117312792276, 0.04226977577524951, 0.04126642770352284, 0.04031010879443365, 0.03938635030680604, 0.03848524101069498, 0.03759509500104093, 0.036709755004648716]

Q = 120
dat6 = [0.4299370505251123, 0.3979118960138492, 0.36733814801889164, 0.3381920866051131, 0.31046071974529094, 0.28413112353368447, 0.2591947780922749, 0.23564085864423429, 0.21345196675956685, 0.19260773209227894, 0.17307785614909535, 0.15482503652656285, 0.13780962225375581, 0.12197884828719951, 0.10728255793075148, 0.09366504800742763, 0.08107205467793478, 0.06944847717893872, 0.05874527548267573, 0.048913349306424346, 0.03990957787151833, 0.03169552778247944, 0.024234187362524934, 0.017494150026583978, 0.011444561960581925, 0.006054719671833537, 0.001294988848285879, -0.0028671900883461662, -0.006466555249076466, -0.00954113854402815, -0.012131215217623429, -0.014281615079141]

err6 = [0.08411060182052817, 0.08163481683225164, 0.07921774631241757, 0.07686970955033064, 0.07458880693961642, 0.07237110755622427, 0.07020700818728942, 0.06809139507747038, 0.06600723965588688, 0.06394764572451811, 0.06190683833126552, 0.05988126042365102, 0.05787154424123952, 0.055882766054122776, 0.053924054789966494, 0.052006174477027836, 0.05014399575660016, 0.04835169327159591, 0.04664296653949915, 0.045028849082924004, 0.04351772597808251, 0.04211372442633315, 0.040817016391131805, 0.03962184558573637, 0.03851909637975018, 0.037498574447650444, 0.0365450343777978, 0.035644475737133315, 0.03478317214684317, 0.03394708344227687, 0.033131870795714516, 0.032323047913564405]

def select_rows(arr):
    return arr[(arr[:, 0] >= 0.3) & (arr[:, 0] <= 0.7)]

mu0 = 2
# Sample only 10 different x to avoid the strong correlations.
x_select = 3*np.array(range(10))

output_data1 = select_rows(np.transpose([x_vals, t_vals[0]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat1, err1]))[x_select]
output_data2 = select_rows(np.transpose([x_vals, t_vals[1]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat2, err2]))[x_select]
output_data3 = select_rows(np.transpose([x_vals, t_vals[2]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat3, err3]))[x_select]
output_data4 = select_rows(np.transpose([x_vals, t_vals[3]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat4, err4]))[x_select]
output_data5 = select_rows(np.transpose([x_vals, t_vals[4]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat5, err5]))[x_select]
output_data6 = select_rows(np.transpose([x_vals, t_vals[5]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat6, err6]))[x_select]

output_data = np.vstack([output_data1, output_data2, output_data3, output_data4, output_data5, output_data6])

df = pd.DataFrame(output_data, columns = ["x", "t", "mu", "f", "delta f"])
df["GPD type"] = 1
df["flavor"] = "NS"

print(df)

df.to_csv("E_LI.csv", index=False)