import numpy as np
import pandas as pd

x_vals = [0.39698492, 0.40703518, 0.41708543, 0.42713568, 0.43718593, 0.44723618,
            0.45728643, 0.46733668, 0.47738693, 0.48743719, 0.49748744, 0.50753769,
            0.51758794, 0.52763819, 0.53768844, 0.54773869, 0.55778894, 0.5678392,
            0.57788945, 0.5879397,  0.59798995, 0.6080402,  0.61809045, 0.6281407,
            0.63819095, 0.64824121, 0.65829146, 0.66834171, 0.67839196, 0.68844221,
            0.69849246, 0.70854271]

# 100 -> 0.17, 200->0.65, 300->1.38, 110->0.34, 220->1.24, 120->0.81
t_vals = -1*np.array([0.17,0.65,1.38,0.34,1.24,0.81])

Q = 100
dat1 = [0.8536991139985278, 0.8205903843517082, 0.7877125297636539, 0.7550987281080024, 0.7227833501117318, 0.6908019385252847, 0.6591912340164223, 0.62798532958667, 0.5972152249258251, 0.5669134176885019, 0.5371066462795192, 0.5078227305566606, 0.4790874068005869, 0.4509279100819195, 0.4233703863706816, 0.3964445817854616, 0.3701813286919627, 0.34461494859805464, 0.3197826056409056, 0.29572297343363924, 0.27247781228881707, 0.2500870670302463, 0.22859066783837026, 0.2080259075893115, 0.18842656669286212, 0.16981853845173936, 0.1522219932039804, 0.13564821744532898, 0.12010041833346255, 0.10557137029129834, 0.092046770451134, 0.07950304946136087]

err1 = [0.03840764596932768, 0.03731974956560904, 0.036242162393325394, 0.035178717818077694, 0.03413114248209563, 0.03309991394255614, 0.03208240657002707, 0.03107968787879415, 0.03008103381872471, 0.029091845266008925, 0.028110020903304493, 0.02713291692928291, 0.026160697718672625, 0.025195847617377642, 0.024241060033919248, 0.023300645821240442, 0.022377678614730924, 0.021479618953400687, 0.020610295552683303, 0.01977395775074717, 0.01897550569824313, 0.018217810133604136, 0.017501447503555055, 0.016828731885657235, 0.016196895270855296, 0.015605158875258382, 0.015049599503985624, 0.014527137642778819, 0.01403351871419462, 0.013565027203309467, 0.01311845478471509, 0.012690939995951849]

Q = 200
dat2 = [0.6602027990011382, 0.6386912926280992, 0.6171477100864756, 0.5955820094709395, 0.5740064078503195, 0.5524366253335473, 0.5308892024599462, 0.5093832793272338, 0.4879379214341915, 0.46657441866998367, 0.44531404872782104, 0.42418054006816214, 0.40319833241540426, 0.38239516279584207, 0.36179965624198396, 0.3414431323163507, 0.3213612390493043, 0.3015905121114141, 0.28217166393824755, 0.26314578947049305, 0.2445561470388094, 0.22644632548957933, 0.20885861807541803, 0.1918351999599653, 0.17541321729340367, 0.1596272251077752, 0.14450630497013378, 0.1300742687839461, 0.1163491732250731, 0.10334208130707172, 0.09105915567274112, 0.07949993875573023]

err2 = [0.03777078365243993, 0.03673612009066729, 0.03571959655774617, 0.034721817317535396, 0.03374139102531521, 0.03277664822849145, 0.031822699269814896, 0.030875832526913373, 0.029932251263311303, 0.028988559486437207, 0.028042068041455905, 0.027091832133165968, 0.026138035938905808, 0.025183252967564705, 0.024233743392272186, 0.02328521912472037, 0.022352932194099236, 0.02144078331686651, 0.020554740871298872, 0.019701895582395587, 0.018887775287354504, 0.018117229436449406, 0.017393325017819056, 0.016718599331393816, 0.016092995006863477, 0.015515147519053925, 0.014982256844063523, 0.014491944268310871, 0.014039373397396705, 0.013621565915754913, 0.013232387386599787, 0.012868992404313368]

Q = 300
dat3 = [0.47973474498533863, 0.46635366552142543, 0.45283477817058604, 0.4391879677505269, 0.4254250161751313, 0.41155838060287836, 0.3976014770245351, 0.38356796118846576, 0.36947186285043265, 0.35532843659117563, 0.3411530439910872, 0.3269625114587606, 0.3127746558068934, 0.29860951985347567, 0.284487677493013, 0.2704324268079618, 0.256468927089591, 0.24262403829639712, 0.22892675748638516, 0.21540684093248522, 0.20209537555194265, 0.18902376379224667, 0.17622299717640375, 0.16372289771260565, 0.15155214923572863, 0.13973654734024016, 0.1282988921826974, 0.11725926329702469, 0.10663365658736558, 0.09643486102668798, 0.08667167642024232, 0.0773494733296929]

err3 = [0.04795299972110869, 0.04679144735198953, 0.04565226551094862, 0.04453525419735388, 0.04343790219948418, 0.042356080701054254, 0.041284076178123255, 0.04021665289100594, 0.039148784957802114, 0.038076739814822944, 0.0369981866431625, 0.03591302060329058, 0.034824348896859474, 0.03373591917325777, 0.032654121070503014, 0.0315865766456024, 0.030541833058174754, 0.029528277607494775, 0.028554886841175735, 0.027627842098895766, 0.026752283591146033, 0.025931371122645056, 0.02516546482060995, 0.024452048921216923, 0.02378811179920675, 0.023167324300577757, 0.022581744865516874, 0.02202490371090112, 0.0214887468068109, 0.020966591717227624, 0.020452189732876408, 0.01994048388416216]

Q = 110
dat4 = [0.6355442579447392, 0.6102398614567264, 0.5853395930553364, 0.560856296410642, 0.5368054702427745, 0.5132036357745189, 0.4900674853497585, 0.4674121369522952, 0.44525035102101135, 0.4235928822765167, 0.4024470313670084, 0.3818179966562837, 0.361710093097112, 0.3421246245407041, 0.323063603897902, 0.3045295133008786, 0.28652597034956306, 0.26905804290720053, 0.2521334991502237, 0.23576190315696277, 0.21995536820607964, 0.20472627176866537, 0.19008820744026314, 0.17605458589045148, 0.16263709673436622, 0.1498440156969353, 0.13768315933760245, 0.12615421041289918, 0.11525585093858258, 0.10497859348197999, 0.09531164372886579, 0.08623664959833646]

err4 = [0.042964617462258006, 0.04150429981698169, 0.04010243368887803, 0.03875999055363672, 0.0374798681748587, 0.036259134192273494, 0.035093841131513696, 0.03397779007968483, 0.032904146390378676, 0.03186689441296904, 0.030860552011395755, 0.029880703820472258, 0.0289250984501638, 0.02799413109452828, 0.02708893505434761, 0.02621204155612631, 0.02536685556703619, 0.024559657454386905, 0.023792684407310354, 0.023068650659447455, 0.022390448837079586, 0.021756061021718988, 0.021164572687767804, 0.02061212126495617, 0.020093040822024337, 0.019600911655872837, 0.019128696597587074, 0.01866912243307352, 0.018217123668684786, 0.017764783053181146, 0.01731011528617981, 0.01684877278293937]

Q = 220
dat5 = [0.4994797263002464, 0.4842136840624422, 0.4688363581399691, 0.4533850586307272, 0.4378941133080931, 0.4223971627326816, 0.40692480716558166, 0.39150572408521483, 0.3761660339362494, 0.36093018781807573, 0.34582077809556067, 0.3308592301177608, 0.3160656921129596, 0.3014611360690124, 0.28706455813257853, 0.272897272147144, 0.2589801561069604, 0.24533519568809867, 0.23198559692409793, 0.21895445287903031, 0.20626560557343648, 0.19394250633691698, 0.1820080193705534, 0.1704835143170911, 0.15938874955137466, 0.14874002167133213, 0.1385514043391423, 0.12883267308891888, 0.11959068757199286, 0.11082808728164108, 0.10254438327170193, 0.09473466070145094]

err5 = [0.05611461509643527, 0.05400136724727494, 0.051961780262798, 0.05000312985520427, 0.048130946893369345, 0.04634651627458231, 0.044647064098270094, 0.04302785726478452, 0.04148289914073462, 0.04000423846918947, 0.038586069346962786, 0.037222617503092886, 0.035909607090933764, 0.03464429642899075, 0.033426823639087604, 0.0322579892346337, 0.031139013284014402, 0.030073461419918134, 0.02906344685416458, 0.028110528839406016, 0.027215068546437873, 0.02637549589193444, 0.025589898419904288, 0.02485246027512018, 0.024158276285323355, 0.023500668005610025, 0.022872376573904174, 0.022266584119860034, 0.021677219264417746, 0.021101307924929542, 0.020531370182786914, 0.019968563304254183]

Q = 120
dat6 = [0.5637253376179221, 0.5422666399493459, 0.5209139513280888, 0.4997089549766901, 0.4786920574790169, 0.4579013853335818, 0.4373732778805229, 0.41714029056038693, 0.39723110210824825, 0.37767211997515665, 0.3584852260548814, 0.33969028563313064, 0.321304572688294, 0.30334474325508637, 0.28582587368899043, 0.2687638800591795, 0.2521737401683088, 0.23607361590053044, 0.2204811101622029, 0.20541764394726705, 0.19090195466960322, 0.17695459616334586, 0.16359545044988189, 0.1508435383783047, 0.13871479208614595, 0.12722152423468414, 0.11637289938886104, 0.10617183659254091, 0.09661806579035284, 0.08770415854228243, 0.07941928838094628, 0.07174633146662784]

err6 = [0.03771891020133746, 0.03638603453323827, 0.0350894678237229, 0.03383422549250109, 0.032622737232537606, 0.03145535794074929, 0.030331320300935778, 0.029248353548082164, 0.028202197298941165, 0.02719106694218679, 0.026212071815796604, 0.0252627556694673, 0.024342892307462265, 0.023452941093103693, 0.022594070697981625, 0.021773321367315843, 0.02098318254225488, 0.020237126703030555, 0.019542189452975107, 0.018881759004209863, 0.01827573822566515, 0.017717940930418646, 0.01720672030173846, 0.016738371546044194, 0.016308984769332117, 0.015912214606080038, 0.015541867218465046, 0.015192460959061205, 0.014856663829061307, 0.014529808345614795, 0.014206902230411461, 0.013884889861485205]

def select_rows(arr):
    return arr[(arr[:, 0] >= 0.3) & (arr[:, 0] <= 0.7)]

mu0 = 2
# Sample only 10 different x to avoid the strong correlations.
x_select = 3*np.array(range(10))

output_data1 = select_rows(np.transpose([x_vals, t_vals[0]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat1, err1]))[x_select]
output_data2 = select_rows(np.transpose([x_vals, t_vals[1]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat2, err2]))[x_select]
output_data3 = select_rows(np.transpose([x_vals, t_vals[2]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat3, err3]))[x_select]
output_data4 = select_rows(np.transpose([x_vals, t_vals[3]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat4, err4]))[x_select]
output_data5 = select_rows(np.transpose([x_vals, t_vals[4]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat5, err5]))[x_select]
output_data6 = select_rows(np.transpose([x_vals, t_vals[5]*np.ones_like(x_vals),mu0*np.ones_like(x_vals), dat6, err6]))[x_select]

output_data = np.vstack([output_data1, output_data2, output_data3, output_data4, output_data5, output_data6])

df = pd.DataFrame(output_data, columns = ["x", "t", "mu", "f", "delta f"])
df["GPD type"] = 0
df["flavor"] = "NS"

print(df)

df.to_csv("H_LI.csv", index=False)

